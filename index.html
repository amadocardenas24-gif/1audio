<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Video Experience - Tropical AR</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
        }

        body {
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }

        /* Pantalla de carga */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #FF6B6B 0%, #FFE66D 25%, #4ECDC4 50%, #1A535C 75%, #FF6B6B 100%);
            background-size: 400% 400%;
            animation: gradientBG 8s ease infinite;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 1s ease;
        }

        .loading-content {
            text-align: center;
            padding: 20px;
            max-width: 80%;
        }

        .loading-title {
            font-size: 3rem;
            color: white;
            text-shadow: 3px 3px 0 #1A535C,
                         -2px -2px 0 #4ECDC4;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }

        .loading-subtitle {
            font-size: 1.5rem;
            color: #1A535C;
            margin-bottom: 40px;
            font-weight: bold;
        }

        /* Gr치fica animada de palmeras */
        .palm-trees {
            position: relative;
            width: 300px;
            height: 200px;
            margin: 30px auto;
        }

        .palm-trunk {
            position: absolute;
            bottom: 0;
            width: 20px;
            background: linear-gradient(to right, #8B4513, #A0522D);
            border-radius: 10px;
        }

        .trunk-1 { left: 50px; height: 120px; }
        .trunk-2 { left: 150px; height: 150px; }
        .trunk-3 { left: 250px; height: 100px; }

        .palm-leaves {
            position: absolute;
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #2E8B57, #90EE90);
            border-radius: 0 50% 0 50%;
            transform-origin: bottom center;
            animation: sway 3s infinite ease-in-out;
        }

        .leaves-1 { left: 10px; top: 20px; animation-delay: 0s; }
        .leaves-2 { left: 110px; top: 0; animation-delay: 0.5s; }
        .leaves-3 { left: 210px; top: 40px; animation-delay: 1s; }

        /* Barra de carga */
        .loading-bar-container {
            width: 80%;
            max-width: 400px;
            height: 30px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            overflow: hidden;
            margin: 30px 0;
            border: 3px solid #1A535C;
        }

        .loading-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #FF6B6B, #FFE66D, #4ECDC4, #1A535C);
            background-size: 300% 100%;
            animation: gradientBar 2s infinite linear;
            border-radius: 12px;
            transition: width 0.3s ease;
        }

        /* Porcentaje de carga */
        .loading-percentage {
            font-size: 2rem;
            font-weight: bold;
            color: #1A535C;
            margin-top: 10px;
            text-shadow: 2px 2px 0 white;
        }

        /* Instrucciones */
        .instructions {
            position: absolute;
            bottom: 20px;
            color: white;
            text-align: center;
            width: 100%;
            padding: 0 20px;
            font-size: 1.2rem;
            text-shadow: 1px 1px 2px #1A535C;
            animation: fadeInOut 3s infinite;
        }

        /* Ocultar la escena AR inicialmente */
        #ar-scene {
            opacity: 0;
            transition: opacity 1s ease;
        }

        /* Animaciones */
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes sway {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }

        @keyframes gradientBar {
            0% { background-position: 0% 50%; }
            100% { background-position: 300% 50%; }
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* Animaci칩n de burbujas */
        .bubbles {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: floatUp 8s infinite ease-in;
        }

        @keyframes floatUp {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) scale(1);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Pantalla de carga tropical -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-content">
            <h1 class="loading-title">游꺖 AR TROPICAL 游꺜</h1>
            <p class="loading-subtitle">Cargando experiencia de Realidad Aumentada</p>
            
            <!-- Gr치fica de palmeras -->
            <div class="palm-trees">
                <div class="palm-trunk trunk-1"></div>
                <div class="palm-trunk trunk-2"></div>
                <div class="palm-trunk trunk-3"></div>
                
                <div class="palm-leaves leaves-1"></div>
                <div class="palm-leaves leaves-2"></div>
                <div class="palm-leaves leaves-3"></div>
            </div>
            
            <!-- Barra de carga -->
            <div class="loading-bar-container">
                <div class="loading-bar" id="loadingBar"></div>
            </div>
            
            <!-- Porcentaje -->
            <div class="loading-percentage" id="loadingPercentage">0%</div>
            
            <!-- Instrucciones -->
            <p class="instructions">游댌 Apunta la c치mara al marcador para ver el video en AR</p>
        </div>
        
        <!-- Burbujas decorativas -->
        <div class="bubbles" id="bubbles"></div>
    </div>

    <!-- Escena AR (oculta inicialmente) -->
    <div id="ar-scene">
        <a-scene mindar-image="imageTargetSrc: ./marker.mind;" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false" renderer="colorManagement: true;">
            <a-assets>
                <video id="ar-video" src="./asset.mp4" loop muted playsinline crossorigin="anonymous"></video>
            </a-assets>
            <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
            <a-entity id="ar-target" mindar-image-target="targetIndex: 0">
                <a-plane
                    src="#ar-video"
                    position="0 0 0"
                    rotation="0 0 0"
                    height="1"
                    width="1.8076923076923077"
                ></a-plane>
            </a-entity>
        </a-scene>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos DOM
            const loadingScreen = document.getElementById('loadingScreen');
            const loadingBar = document.getElementById('loadingBar');
            const loadingPercentage = document.getElementById('loadingPercentage');
            const arScene = document.getElementById('ar-scene');
            const bubblesContainer = document.getElementById('bubbles');
            const arTarget = document.querySelector('#ar-target');
            const video = document.querySelector('#ar-video');
            
            // Crear burbujas decorativas
            function createBubbles() {
                for (let i = 0; i < 20; i++) {
                    const bubble = document.createElement('div');
                    bubble.className = 'bubble';
                    
                    // Tama침o aleatorio
                    const size = Math.random() * 60 + 20;
                    bubble.style.width = `${size}px`;
                    bubble.style.height = `${size}px`;
                    
                    // Posici칩n aleatoria
                    bubble.style.left = `${Math.random() * 100}%`;
                    
                    // Retraso de animaci칩n aleatorio
                    bubble.style.animationDelay = `${Math.random() * 5}s`;
                    
                    // Color aleatorio de la paleta tropical
                    const colors = [
                        'rgba(255, 107, 107, 0.4)',
                        'rgba(255, 230, 109, 0.4)',
                        'rgba(78, 205, 196, 0.4)',
                        'rgba(26, 83, 92, 0.4)'
                    ];
                    bubble.style.background = colors[Math.floor(Math.random() * colors.length)];
                    
                    bubblesContainer.appendChild(bubble);
                }
            }
            
            // Simular progreso de carga
            let progress = 0;
            const loadingInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                if (progress > 100) progress = 100;
                
                loadingBar.style.width = `${progress}%`;
                loadingPercentage.textContent = `${Math.round(progress)}%`;
                
                if (progress >= 100) {
                    clearInterval(loadingInterval);
                    
                    // Esperar un momento y luego ocultar pantalla de carga
                    setTimeout(() => {
                        loadingScreen.style.opacity = '0';
                        
                        setTimeout(() => {
                            loadingScreen.style.display = 'none';
                            arScene.style.opacity = '1';
                            
                            // Inicializar eventos AR despu칠s de mostrar la escena
                            arTarget.addEventListener('targetFound', () => { 
                                video.play().catch(e => console.error("Error al reproducir video", e)); 
                            });
                            arTarget.addEventListener('targetLost', () => { 
                                video.pause(); 
                            });
                        }, 1000);
                    }, 800);
                }
            }, 200);
            
            // Crear burbujas al inicio
            createBubbles();
            
            // Crear m치s burbujas peri칩dicamente
            setInterval(() => {
                if (loadingScreen.style.display !== 'none') {
                    const bubble = document.createElement('div');
                    bubble.className = 'bubble';
                    const size = Math.random() * 40 + 10;
                    bubble.style.width = `${size}px`;
                    bubble.style.height = `${size}px`;
                    bubble.style.left = `${Math.random() * 100}%`;
                    bubble.style.background = 'rgba(255, 255, 255, 0.3)';
                    bubblesContainer.appendChild(bubble);
                    
                    // Remover burbuja despu칠s de animaci칩n
                    setTimeout(() => {
                        if (bubble.parentNode) {
                            bubble.parentNode.removeChild(bubble);
                        }
                    }, 8000);
                }
            }, 1000);
        });
    </script>
</body>
</html>
